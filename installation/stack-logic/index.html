
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Linux Server Administrator Guide">
      
      
      
        <meta name="author" content="https://github.com/felbinger">
      
      
        <link rel="canonical" href="https://felbinger.github.io/AdminGuide/installation/stack-logic/">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.2.8">
    
    
      
        <title>Stack Logic - Admin Guide</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.cb6bc1d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.39b8e14a.min.css">
        
          
          
          <meta name="theme-color" content="#4cae4f">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="green" data-md-color-accent="lime">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://felbinger.github.io/AdminGuide/" title="Admin Guide" class="md-header-nav__button md-logo" aria-label="Admin Guide">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      <div class="md-header-nav__ellipsis">
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            Admin Guide
          </span>
        </div>
        <div class="md-header-nav__topic">
          <span class="md-ellipsis">
            
              Stack Logic
            
          </span>
        </div>
      </div>
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/felbinger/AdminGuide/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    felbinger/AdminGuide
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://felbinger.github.io/AdminGuide/" title="Admin Guide" class="md-nav__button md-logo" aria-label="Admin Guide">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Admin Guide
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/felbinger/AdminGuide/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    felbinger/AdminGuide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
      
      <label class="md-nav__link" for="nav-2">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="nav-2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Base
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dns/" class="md-nav__link">
        Configure DNS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Stack Logic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Stack Logic
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" data-md-state="indeterminate" type="checkbox" id="nav-3" checked>
      
      <label class="md-nav__link" for="nav-3">
        Services
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Services" data-md-level="1">
        <label class="md-nav__title" for="nav-3">
          <span class="md-nav__icon md-icon"></span>
          Services
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" data-md-state="indeterminate" type="checkbox" id="nav-3-1" checked>
      
      <label class="md-nav__link" for="nav-3-1">
        Proxies
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Proxies" data-md-level="2">
        <label class="md-nav__title" for="nav-3-1">
          <span class="md-nav__icon md-icon"></span>
          Proxies
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/traefik/" class="md-nav__link">
        Traefik
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/nginx-proxy/" class="md-nav__link">
        nginx/proxy
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/docky-onion/" class="md-nav__link">
        docky-onion
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" data-md-state="indeterminate" type="checkbox" id="nav-3-2" checked>
      
      <label class="md-nav__link" for="nav-3-2">
        Web Server
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Web Server" data-md-level="2">
        <label class="md-nav__title" for="nav-3-2">
          <span class="md-nav__icon md-icon"></span>
          Web Server
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/nginx/" class="md-nav__link">
        nginx
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/httpd/" class="md-nav__link">
        httpd
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/httpd-php/" class="md-nav__link">
        httpd with php
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" data-md-state="indeterminate" type="checkbox" id="nav-3-3" checked>
      
      <label class="md-nav__link" for="nav-3-3">
        Databases
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Databases" data-md-level="2">
        <label class="md-nav__title" for="nav-3-3">
          <span class="md-nav__icon md-icon"></span>
          Databases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/mariadb/" class="md-nav__link">
        MariaDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/mongodb/" class="md-nav__link">
        MongoDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/postgresql/" class="md-nav__link">
        PostgreSQL
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/redis/" class="md-nav__link">
        Redis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/openldap/" class="md-nav__link">
        OpenLDAP
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" data-md-state="indeterminate" type="checkbox" id="nav-3-4" checked>
      
      <label class="md-nav__link" for="nav-3-4">
        Gameserver
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Gameserver" data-md-level="2">
        <label class="md-nav__title" for="nav-3-4">
          <span class="md-nav__icon md-icon"></span>
          Gameserver
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/minecraft/" class="md-nav__link">
        Minecraft
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/arma3/" class="md-nav__link">
        Arma 3 Server
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" data-md-state="indeterminate" type="checkbox" id="nav-3-5" checked>
      
      <label class="md-nav__link" for="nav-3-5">
        Communication
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Communication" data-md-level="2">
        <label class="md-nav__title" for="nav-3-5">
          <span class="md-nav__icon md-icon"></span>
          Communication
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/teamspeak/" class="md-nav__link">
        Teamspeak 3 + Sinusbot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/matrix/" class="md-nav__link">
        Matrix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/element/" class="md-nav__link">
        Element
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/jitsi/" class="md-nav__link">
        Jitsi
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" data-md-state="indeterminate" type="checkbox" id="nav-3-6" checked>
      
      <label class="md-nav__link" for="nav-3-6">
        Storage
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Storage" data-md-level="2">
        <label class="md-nav__title" for="nav-3-6">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/syncthing/" class="md-nav__link">
        Syncthing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/sharelatex/" class="md-nav__link">
        ShareLaTeX
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/hackmd/" class="md-nav__link">
        HackMD
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/calibre/" class="md-nav__link">
        Calibre
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../services/monitoring/" class="md-nav__link">
        Monitoring
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    Getting Started
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/felbinger/AdminGuide/edit/master/docs/installation/stack-logic.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Stack Logic</h1>
                
                <p>We will group the services in different "stacks" to manage them, this way we can change specific things without taking all services offline. Furthermore, we will use one docker network per stack to ensure, that each container is only able to communicate with other containers which it really needs.</p>
<h2 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>First, let's add the default directories into the admin directory:</p>
<div class="highlight"><pre><span></span><code>mkdir -p /home/admin/<span class="o">{</span>services,images,tools,docs<span class="o">}</span>/
</code></pre></div>
<table>
<thead>
<tr>
<th>name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>services</td>
<td>contains the <code>docker-compose</code> and <code>.env</code> files</td>
</tr>
<tr>
<td>images</td>
<td>contains the data for custom docker images</td>
</tr>
<tr>
<td>tools</td>
<td>contains various tools</td>
</tr>
<tr>
<td>docs</td>
<td>contains the documentations of you server</td>
</tr>
</tbody>
</table>
<p>For each stack we will create, we want to have a directory in <code>/home/admin/services/</code>, <code>/home/admin/images/</code> and <code>/srv/</code>:</p>
<ul>
<li>The directory in <code>/home/admin/services/</code> contains the <code>docker-compose.yml</code> and <code>.env</code> files. Which is later used in the <code>docker-compose.yml</code> as <code>env_file</code>.</li>
<li>The directory in <code>/home/admin/images/</code> contains the source files for the docker image if we have to build the image on the server.</li>
<li>The directory in <code>/srv/</code> is used to store persistent data for the stack (docker volumes).</li>
</ul>
<p>We will also create multiple docker networks, to give the containers the ability to communicate with each other.
Helper networks for specific communication (e.g. to the reverse proxy, the databases or the monitoring) start at <code>192.168.0.0/24</code>. Stack networks (one network for each stack) start at <code>192.168.100.0/24</code>.</p>
<div class="admonition note">
<p>Note that a network with the submask 255.255.255.0 (cidr notation is 24) can only contain 254 hosts.
You have to adjust your network size to your needs.</p>
<p>Remember the formular: <span class="arithmatex">\(2^{32-x}-2\)</span> where <span class="arithmatex">\(x\)</span> is your submask in cidr notation<br />
(e.g. with <span class="arithmatex">\(24\)</span>: <span class="arithmatex">\(2^{32−24}−2=254\)</span>; or with <span class="arithmatex">\(20\)</span>: <span class="arithmatex">\(2^{32−20}−2=4094\)</span> usable adresses)</p>
</div>
<table>
<thead>
<tr>
<th align="left">Name</th>
<th align="left">Subnet</th>
<th align="left">Usage</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Proxy</td>
<td align="left">192.168.0.0/24</td>
<td align="left">Container communication to nginx reverse proxy.</td>
</tr>
<tr>
<td align="left">Database</td>
<td align="left">192.168.1.0/24</td>
<td align="left">Communication to databases (MariaDB, MongoDB, PostgreSQL).</td>
</tr>
<tr>
<td align="left">Monitoring</td>
<td align="left">192.168.2.0/24</td>
<td align="left">Communication to monitoring utilities (InfluxDB).</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Main</td>
<td align="left">192.168.100.0/24</td>
<td align="left">Network for the Main Stack</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="c1"># create main stack</span>
<span class="nv">name</span><span class="o">=</span><span class="s1">&#39;main&#39;</span>
mkdir -p <span class="s2">&quot;/home/admin/{services,images}/</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">/&quot;</span>
sudo mkdir -p <span class="s2">&quot;/srv/</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">/&quot;</span>
sudo docker network create --subnet <span class="m">192</span>.168.100.0/24 <span class="si">${</span><span class="nv">name</span><span class="si">}</span>

<span class="c1"># create helper networks (we will need them in the next chapter)</span>
sudo docker network create --subnet <span class="m">192</span>.168.0.0/24 proxy
sudo docker network create --subnet <span class="m">192</span>.168.1.0/24 database
sudo docker network create --subnet <span class="m">192</span>.168.2.0/24 monitoring
</code></pre></div>
<p>You can create as many stacks, as you need. The main stack contains the services that are relevant for the majority of the services (e.g. reverse proxy, static webserver for the reverse proxy, databases, admin panels (because they are related to the databases), monitoring). All other services will be outsourced to another stack. The following list containers just a few ideas, how you could name them:</p>
<ul>
<li>
<p>games: all game servers<br />
(e.g. Minecraft, Arma 3)</p>
</li>
<li>
<p>storage: applications that store your data<br />
(e.g. NextCloud, Syncthing, ...)</p>
</li>
<li>
<p>comms (short form of communication): things to communicate<br />
(e.g. TeamSpeak, Sinusbot, Telegram Bots, Discord Bots)</p>
</li>
<li>
<p>jitsi: another video conference system (simply use <a href="https://github.com/jitsi/docker-jitsi-meet">their configuration on github</a>)</p>
</li>
</ul>
<p>Lastly we are going to create a <code>docker-compose.yml</code> which we will use to define our networks.</p>
<div class="highlight"><pre><span></span><code><span class="nt">version</span><span class="p">:</span> <span class="s">&quot;3&quot;</span>
<span class="nt">services</span><span class="p">:</span> 
  <span class="l l-Scalar l-Scalar-Plain">...</span>     <span class="c1"># you need to add your services right here...</span>

<span class="nt">networks</span><span class="p">:</span>
  <span class="nt">default</span><span class="p">:</span>
    <span class="nt">external</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">main</span>
  <span class="nt">proxy</span><span class="p">:</span>
    <span class="nt">external</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">proxy</span>
  <span class="nt">database</span><span class="p">:</span>
    <span class="nt">external</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">database</span>
  <span class="nt">monitoring</span><span class="p">:</span>
    <span class="nt">external</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">monitoring</span>
</code></pre></div>
<p>The network created for a particular stack will be called <code>default</code> in the matching <code>docker-compose.yml</code>.
This will help us, because if we do not specify a network in the service sections of the <code>docker-compose.yml</code>, these services will automatically connect network <code>default</code>.</p>
<details>
  <summary>Parts of the PostInstall script covered in this chapter</summary>

<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1">## CONFIGURATION ###</span>
<span class="nv">ADM_NAME</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span>
<span class="nv">ADM_GID</span><span class="o">=</span><span class="m">997</span>
<span class="nv">ADM_HOME</span><span class="o">=</span><span class="s1">&#39;/home/admin&#39;</span>
<span class="nv">ADM_USERS</span><span class="o">=(</span><span class="s1">&#39;user&#39;</span><span class="o">)</span>

<span class="nb">declare</span> -A <span class="nv">STACKS</span><span class="o">=(</span><span class="se">\</span>
  <span class="o">[</span><span class="s2">&quot;main&quot;</span><span class="o">]=</span><span class="s2">&quot;192.168.100.0/24&quot;</span>
<span class="o">)</span>

<span class="nb">declare</span> -A <span class="nv">HELPER</span><span class="o">=(</span><span class="se">\</span>
  <span class="o">[</span><span class="s2">&quot;proxy&quot;</span><span class="o">]=</span><span class="s2">&quot;192.168.0.0/24&quot;</span> <span class="se">\</span>
  <span class="o">[</span><span class="s2">&quot;database&quot;</span><span class="o">]=</span><span class="s2">&quot;192.168.1.0/24&quot;</span> <span class="se">\</span>
  <span class="o">[</span><span class="s2">&quot;monitoring&quot;</span><span class="o">]=</span><span class="s2">&quot;192.168.2.0/24&quot;</span>
<span class="o">)</span>
<span class="c1">### END of CONFIGURATION ###</span>

<span class="k">function</span> docker_network_create<span class="o">()</span> <span class="o">{</span>
  <span class="nv">name</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span>
  <span class="nv">subnet</span><span class="o">=</span><span class="si">${</span><span class="nv">2</span><span class="si">}</span>
  docker network inspect <span class="si">${</span><span class="nv">name</span><span class="si">}</span> &gt;/dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="o">||</span> <span class="se">\</span>
  docker network create --subnet <span class="si">${</span><span class="nv">subnet</span><span class="si">}</span> <span class="si">${</span><span class="nv">name</span><span class="si">}</span>
<span class="o">}</span>

<span class="k">function</span> create_compose<span class="o">()</span> <span class="o">{</span>
  <span class="nv">compose</span><span class="o">=</span><span class="si">${</span><span class="nv">1</span><span class="si">}</span>
  touch <span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;version: &#39;3.8&#39;\n&quot;</span> &gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>

  <span class="c1"># define services</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;services:\n&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
  <span class="k">if</span> <span class="o">[[</span> <span class="si">${#</span><span class="nv">SERVICES</span><span class="si">}</span> <span class="o">==</span> <span class="m">0</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;  test:&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;    image: hello-world\n&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
  <span class="k">fi</span>

  <span class="nb">echo</span> -e <span class="s2">&quot;\n&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>

  <span class="c1"># define networks</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;networks:&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>

  <span class="c1"># define stack network</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;  default:&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;    external:&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
  <span class="nb">echo</span> -e <span class="s2">&quot;      name: </span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>

  <span class="c1"># define helper networks</span>
  <span class="k">for</span> helper_name <span class="k">in</span> <span class="si">${</span><span class="p">!HELPER[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;  </span><span class="si">${</span><span class="nv">helper_name</span><span class="si">}</span><span class="s2">:&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;    external:&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
    <span class="nb">echo</span> -e <span class="s2">&quot;      name: </span><span class="si">${</span><span class="nv">helper_name</span><span class="si">}</span><span class="s2">&quot;</span> &gt;&gt;<span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
  <span class="k">done</span>
<span class="o">}</span>

<span class="c1"># remove trailing slash from ADM_HOME</span>
<span class="o">[[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">==</span> */ <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nv">ADM_HOME</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ADM_HOME</span><span class="p">:</span><span class="k">:-</span><span class="nv">1</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># create admin group, add members to group and set permissions</span>
groupadd -g <span class="si">${</span><span class="nv">ADM_GID</span><span class="si">}</span> <span class="si">${</span><span class="nv">ADM_NAME</span><span class="si">}</span>
mkdir <span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span>
chown -R root:<span class="si">${</span><span class="nv">ADM_NAME</span><span class="si">}</span> <span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span>
chmod -R <span class="m">775</span> <span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span>
<span class="k">for</span> user <span class="k">in</span> <span class="si">${</span><span class="nv">ADM_USERS</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
  adduser <span class="si">${</span><span class="nv">user</span><span class="si">}</span> <span class="si">${</span><span class="nv">ADM_NAME</span><span class="si">}</span>
<span class="k">done</span>

<span class="c1"># create helper networks</span>
<span class="k">for</span> name <span class="k">in</span> <span class="si">${</span><span class="p">!HELPER[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">subnet</span><span class="o">=</span><span class="si">${</span><span class="nv">HELPER</span><span class="p">[</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>
  docker_network_create <span class="si">${</span><span class="nv">name</span><span class="si">}</span> <span class="si">${</span><span class="nv">subnet</span><span class="si">}</span>
<span class="k">done</span>

<span class="c1"># create stack logic</span>
mkdir -p <span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span>/<span class="o">{</span>services,images,tools,docs<span class="o">}</span>/
<span class="k">for</span> name <span class="k">in</span> <span class="si">${</span><span class="p">!STACKS[@]</span><span class="si">}</span><span class="p">;</span> <span class="k">do</span>
  <span class="nv">subnet</span><span class="o">=</span><span class="si">${</span><span class="nv">STACKS</span><span class="p">[</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="p">]</span><span class="si">}</span>
  mkdir -p <span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span>/<span class="o">{</span>services,images<span class="o">}</span>/<span class="si">${</span><span class="nv">name</span><span class="si">}</span>/
  mkdir -p <span class="s2">&quot;/srv/</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">/&quot;</span>

  <span class="c1"># create stack network</span>
  docker_network_create <span class="si">${</span><span class="nv">name</span><span class="si">}</span> <span class="si">${</span><span class="nv">subnet</span><span class="si">}</span>

  <span class="c1"># create docker-compose.yml</span>
  <span class="nv">compose</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">ADM_HOME</span><span class="si">}</span><span class="s2">/services/</span><span class="si">${</span><span class="nv">name</span><span class="si">}</span><span class="s2">/docker-compose.yml&quot;</span>
  create_compose <span class="si">${</span><span class="nv">compose</span><span class="si">}</span>
<span class="k">done</span>
</code></pre></div>

</details>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 2, 2021</span>
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../docker/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Docker
              </div>
            </div>
          </a>
        
        
          <a href="../../services/traefik/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Traefik
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.18f0862e.min.js"></script>
      <script src="../../assets/javascripts/bundle.994580cf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['search.suggest', 'search.highlight', 'navigation.expand', 'navigation.instant', 'navigation.sections'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.2/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>